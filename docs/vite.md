# Compiling Assets (Vite)

- [Introduction](#introduction)
  - [Choosing Between Vite and Laravel Mix](#vite-or-mix)
- [Installation & Setup](#installation)
- [Running Vite](#running-vite)
- [Working With JavaScript](#working-with-scripts)
- [Working With Stylesheets](#working-with-stylesheets)
- [Custom Base URLs](#custom-base-urls)
- [Environment Variables](#environment-variables)
- [Server-Side Rendering (SSR)](#ssr)


- [Static Assets](#static-assets)


<a name="introduction"></a>
## Introduction

[Vite](https://vitejs.dev) is a modern frontend build tool that provides an extremely fast development environment and bundles your code for production.

Laravel integrates seamlessly with Vite by providing an official plugin and Blade directive to load your assets for development and production.

<a name="vite-or-mix"></a>
### Choosing Between Vite and Laravel Mix

// TODO

<a name="installation"></a>
## Installation & Setup

// TODO

<a name="running-vite"></a>
## Running Vite

```shell
// Run the Vite development server
npm run dev

// Build and version the assets
npm run build
```

<a name="working-with-scripts"></a>
## Working With JavaScript

To get started, you'll need to configure your JavaScript entry point with the Laravel plugin in your `vite.config.js`:

```js
import { defineConfig } from 'vite'
import laravel from 'laravel-vite-plugin'

export default defineConfig({
    plugins: [
        laravel('resources/js/app.js'),
    ],

    resolve: {
        alias: {
            '@': '/resources/js',
        },
    },
})
```

Entry points may also be TypeScript, JSX, or TSX files. You may also include your own additional Vite configuration, such as the common `@` resolve alias above.

The compiled entry point can be loaded using the `@vite` Blade directive, typically within the `<head>` of your main layout file:

```blade
@vite('resources/js/app.js')
```

When running Vite in development mode, Laravel will automatically launch the Vite hot module replacement client to display your code changes instantly. When running Vite in build mode, your assets will be automatically versioned, and Laravel will load the latest version for you.

If you have multiple entry points, you can pass an array of paths to the Laravel plugin:

```js
laravel([
    'resources/js/app.js',
    'resources/js/admin.js',
]),
```

### Vue

There are a few additional options you may want when using Vue with Laravel:

```js
import { defineConfig } from 'vite'
import laravel from 'laravel-vite-plugin'
import vue from '@vitejs/plugin-vue'

export default defineConfig({
    plugins: [
        laravel('resources/js/app.js'),

        vue({
            template: {
                transformAssetUrls: {
                    base: '',
                    includeAbsolute: false,
                },
            },
        }),
    ],

    resolve: {
        alias: {
            '@': '/resources/js',
        },
    },
})
```

### React

* You will need to use a `.jsx` extension on any files containing JSX.
* You will need to load the React refresh runtime from vite to enable hot module replacement. The `@viteReactRefresh` directive must be called before the `@vite` directive and it will automatically know when you are in development mode.

```blade
@viteReactRefresh
@vite('resources/js/app.jsx')
```

<a name="working-with-stylesheets"></a>
## Working With Stylesheets

When using Vite, it is recommended to import your stylesheets from within your JavaScript files:

```js
import '../css/app.css'
```

When you import the JavaScript using the `@vite` Blade directive, Laravel will automatically load any stylesheets referenced in those files.

<a name="custom-base-urls"></a>
## Custom Base URLs

If your Vite compiled assets are deployed to a CDN separate from your application, you will need to change the base URL generated by the `@vite` directive. You may do so by specifying the `ASSET_URL` environment variable:

```
ASSET_URL=https://cdn.example.com
```

After configuring the asset URL, the `@vite` directive will prefix the configured URL when generating URLs to assets:

```
https://cdn.example.com/build/assets/app.9dce8d17.js
```

<a name="environment-variables"></a>
## Environment Variables

You may inject environment variables into your JavaScript by prefixing one of the environment variables in your `.env` file with `VITE_`:

```env
VITE_SENTRY_DSN_PUBLIC=http://example.com
```

After the variable has been defined in your `.env` file, you may access it via the `import.meta.env` object. However, you will need to restart the task if the environment variable's value changes while the task is running:

```js
import.meta.env.VITE_SENTRY_DSN_PUBLIC
```

<a name="ssr"></a>
## Server-Side Rendering (SSR)

// TODO
